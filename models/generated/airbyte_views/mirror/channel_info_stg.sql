{{ config(
    unique_key = '_airbyte_ab_id',
    schema = "_airbyte_mirror",
    tags = [ "top-level-intermediate" ]
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ ref('channel_info_ab2') }}
select
    {{ dbt_utils.surrogate_key([
        'lang',
        'links',
        'score',
        'title',
        'd_lang',
        'vid_db',
        'country',
        'fb_link',
        'ranking',
        'remarks',
        'vid_api',
        'category',
        'comments',
        'channelid',
        boolean_to_string('hash_data'),
        'is_hidden',
        'is_linked',
        'thumbnail',
        'user_name',
        'viewcount',
        boolean_to_string('is_deleted'),
        'risk_level',
        'subscriber',
        'title_lang',
        'updated_at',
        'description',
        'inserted_at',
        boolean_to_string('is_verified'),
        'lang_status',
        'publishedat',
        'tier_status',
        'video_count',
        'd_lang_score',
        boolean_to_string('is_processed'),
        'topic_status',
        'lang_raw_data',
        'made_for_kids',
        'monthly_views',
        'title_summary',
        'views_history',
        'is_blacklisted',
        'privacy_status',
        'summary_status',
        boolean_to_string('already_updated'),
        'brands_keywords',
        'topiccategories',
        'default_language',
        'last_stats_update',
        'predicted_lang_v1',
        'monthly_updated_at',
        'viewcount_category',
        'white_black_status',
        'description_summary',
        'lang_detected_param',
        'monthly_subscribers',
        'processesing_status',
        'subscriber_category',
        'subscribers_history',
        'featured_channel_list',
    ]) }} as _airbyte_channel_info_hashid,
    tmp.*
from {{ ref('channel_info_ab2') }} tmp
-- channel_info
where 1 = 1
{{ incremental_clause('_airbyte_emitted_at', this) }}


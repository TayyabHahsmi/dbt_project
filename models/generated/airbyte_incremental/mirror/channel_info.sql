{{ config(
    unique_key = "_airbyte_unique_key",
    schema = "mirror",
    tags = [ "top-level" ]
) }}
-- Final base SQL model
-- depends_on: {{ ref('channel_info_scd') }}
select
    _airbyte_unique_key,
    lang,
    links,
    score,
    title,
    d_lang,
    vid_db,
    country,
    fb_link,
    ranking,
    remarks,
    vid_api,
    category,
    comments,
    channelid,
    hash_data,
    is_hidden,
    is_linked,
    thumbnail,
    user_name,
    viewcount,
    is_deleted,
    risk_level,
    subscriber,
    title_lang,
    updated_at,
    description,
    inserted_at,
    is_verified,
    lang_status,
    publishedat,
    tier_status,
    video_count,
    d_lang_score,
    is_processed,
    topic_status,
    lang_raw_data,
    made_for_kids,
    monthly_views,
    title_summary,
    views_history,
    is_blacklisted,
    privacy_status,
    summary_status,
    already_updated,
    brands_keywords,
    topiccategories,
    default_language,
    last_stats_update,
    predicted_lang_v1,
    monthly_updated_at,
    viewcount_category,
    white_black_status,
    description_summary,
    lang_detected_param,
    monthly_subscribers,
    processesing_status,
    subscriber_category,
    subscribers_history,
    featured_channel_list,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    {{ current_timestamp() }} as _airbyte_normalized_at,
    _airbyte_channel_info_hashid
from {{ ref('channel_info_scd') }}
-- channel_info from {{ source('mirror', '_airbyte_raw_channel_info') }}
where 1 = 1
and _airbyte_active_row = 1
{{ incremental_clause('_airbyte_emitted_at', this) }}

